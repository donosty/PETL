2025-12-17 01:09:33,836 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 01:09:33,836 - INFO - -- Paso 1: Extraccion --
2025-12-17 01:09:33,838 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 01:09:33,839 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 01:09:33,840 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 01:09:33,840 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 01:09:33,840 - INFO - -- Paso 2: Transformacion --
2025-12-17 01:09:33,840 - INFO - Iniciando transformacion de los datos...
2025-12-17 01:09:33,840 - ERROR - Error critivo en el Pipeline: Length mismatch: Expected axis has 7 elements, new values have 6 elements
Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 41, in run_pipeline
    df_limpio = transformer.ejecutar_transformacion(lista_dfs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/Escritorio/PETL/src/transform.py", line 76, in ejecutar_transformacion
    lista_norm = self._normalizar_encabezados(lista_dfs_sucios)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/Escritorio/PETL/src/transform.py", line 25, in _normalizar_encabezados
    df.columns = encabezados_sql
    ^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 6313, in __setattr__
    return object.__setattr__(self, name, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 814, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 238, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/internals/base.py", line 98, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 7 elements, new values have 6 elements





2025-12-17 01:20:37,671 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 01:20:37,672 - INFO - -- Paso 1: Extraccion --
2025-12-17 01:20:37,673 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 01:20:37,674 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 01:20:37,675 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 01:20:37,675 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 01:20:37,675 - INFO - -- Paso 2: Transformacion --
2025-12-17 01:20:37,675 - INFO - Iniciando transformacion de los datos...
2025-12-17 01:20:37,679 - INFO - Datos transformados. Total de filas a cargar: 12
2025-12-17 01:20:37,679 - INFO - -- Paso 3: Carga (Load) --
2025-12-17 01:20:37,723 - ERROR - Error critivo en el Pipeline: (psycopg2.OperationalError) could not translate host name "2S7w6@localhost" to address: Name or service not known

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: could not translate host name "2S7w6@localhost" to address: Name or service not known


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 47, in run_pipeline
    loader.cargar_datos(df_limpio, 'fact_ventas')
  File "/home/donosty/Escritorio/PETL/src/load.py", line 41, in cargar_datos
    raise e
  File "/home/donosty/Escritorio/PETL/src/load.py", line 29, in cargar_datos
    df.to_sql(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 841, in to_sql
    with pandasSQL_builder(con, schema=schema, need_transaction=True) as pandas_sql:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 906, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1636, in __init__
    con = self.exit_stack.enter_context(con.connect())
                                        ^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "2S7w6@localhost" to address: Name or service not known

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-17 02:25:17,773 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 02:25:17,773 - INFO - -- Paso 1: Extraccion --
2025-12-17 02:25:17,775 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 02:25:17,775 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 02:25:17,776 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 02:25:17,776 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 02:25:17,776 - INFO - -- Paso 2: Transformacion --
2025-12-17 02:25:17,776 - INFO - Iniciando transformacion de los datos...
2025-12-17 02:25:17,779 - INFO - Datos transformados. Total de filas a cargar: 12
2025-12-17 02:25:17,779 - INFO - -- Paso 3: Carga (Load) --
2025-12-17 02:25:17,779 - INFO - Conectando a: postgresql+psycopg2://donosty:***@localhost:5432/retail_db
2025-12-17 02:25:17,827 - ERROR - Error critivo en el Pipeline: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 47, in run_pipeline
    loader.cargar_datos(df_limpio, 'fact_ventas')
  File "/home/donosty/Escritorio/PETL/src/load.py", line 45, in cargar_datos
    raise e
  File "/home/donosty/Escritorio/PETL/src/load.py", line 33, in cargar_datos
    df.to_sql(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1027, in _execute_insert_multi
    result = conn.execute(stmt)
             ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-17 02:31:31,859 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 02:31:31,859 - INFO - -- Paso 1: Extraccion --
2025-12-17 02:31:31,860 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 02:31:31,861 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 02:31:31,862 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 02:31:31,862 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 02:31:31,862 - INFO - -- Paso 2: Transformacion --
2025-12-17 02:31:31,862 - INFO - Iniciando transformacion de los datos...
2025-12-17 02:31:31,865 - INFO - Datos transformados. Total de filas a cargar: 12
2025-12-17 02:31:31,865 - INFO - -- Paso 3: Carga (Load) --
2025-12-17 02:31:31,865 - INFO - Conectando a: postgresql+psycopg2://donosty:***@localhost:5432/retail_db
2025-12-17 02:31:31,909 - ERROR - Error critivo en el Pipeline: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 47, in run_pipeline
    loader.cargar_datos(df_limpio, 'fact_ventas')
  File "/home/donosty/Escritorio/PETL/src/load.py", line 45, in cargar_datos
    raise e
  File "/home/donosty/Escritorio/PETL/src/load.py", line 33, in cargar_datos
    df.to_sql(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1027, in _execute_insert_multi
    result = conn.execute(stmt)
             ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-17 02:33:35,579 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 02:33:35,579 - INFO - -- Paso 1: Extraccion --
2025-12-17 02:33:35,581 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 02:33:35,582 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 02:33:35,583 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 02:33:35,583 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 02:33:35,583 - INFO - -- Paso 2: Transformacion --
2025-12-17 02:33:35,583 - INFO - Iniciando transformacion de los datos...
2025-12-17 02:33:35,583 - ERROR - Error critivo en el Pipeline: Length mismatch: Expected axis has 7 elements, new values have 6 elements
Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 41, in run_pipeline
    df_limpio = transformer.ejecutar_transformacion(lista_dfs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/Escritorio/PETL/src/transform.py", line 76, in ejecutar_transformacion
    lista_norm = self._normalizar_encabezados(lista_dfs_sucios)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/Escritorio/PETL/src/transform.py", line 25, in _normalizar_encabezados
    df.columns = encabezados_sql
    ^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 6313, in __setattr__
    return object.__setattr__(self, name, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 814, in _set_axis
    self._mgr.set_axis(axis, labels)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/internals/managers.py", line 238, in set_axis
    self._validate_set_axis(axis, new_labels)
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/internals/base.py", line 98, in _validate_set_axis
    raise ValueError(
ValueError: Length mismatch: Expected axis has 7 elements, new values have 6 elements







2025-12-17 02:34:20,151 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 02:34:20,151 - INFO - -- Paso 1: Extraccion --
2025-12-17 02:34:20,153 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 02:34:20,154 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 02:34:20,154 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 02:34:20,154 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 02:34:20,154 - INFO - -- Paso 2: Transformacion --
2025-12-17 02:34:20,154 - INFO - Iniciando transformacion de los datos...
2025-12-17 02:34:20,158 - INFO - Datos transformados. Total de filas a cargar: 12
2025-12-17 02:34:20,158 - INFO - -- Paso 3: Carga (Load) --
2025-12-17 02:34:20,158 - INFO - Conectando a: postgresql+psycopg2://donosty:***@localhost:5432/retail_db
2025-12-17 02:34:20,200 - ERROR - Error critivo en el Pipeline: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/donosty/Escritorio/PETL/main.py", line 47, in run_pipeline
    loader.cargar_datos(df_limpio, 'fact_ventas')
  File "/home/donosty/Escritorio/PETL/src/load.py", line 45, in cargar_datos
    raise e
  File "/home/donosty/Escritorio/PETL/src/load.py", line 33, in cargar_datos
    df.to_sql(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/pandas/io/sql.py", line 1027, in _execute_insert_multi
    result = conn.execute(stmt)
             ^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/donosty/anaconda3/envs/jupyter_env/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) no existe la columna «origen_archivo» en la relación «fact_ventas»
LINE 1: ...a, producto, cantidad, precio_unitario, sucursal, origen_arc...
                                                             ^

[SQL: INSERT INTO fact_ventas (id_venta_original, fecha_venta, producto, cantidad, precio_unitario, sucursal, origen_archivo, total_venta) VALUES (%(id_venta_original_m0)s, %(fecha_venta_m0)s, %(producto_m0)s, %(cantidad_m0)s, %(precio_unitario_m0)s, %(sucursal_m0)s, %(origen_archivo_m0)s, %(total_venta_m0)s), (%(id_venta_original_m1)s, %(fecha_venta_m1)s, %(producto_m1)s, %(cantidad_m1)s, %(precio_unitario_m1)s, %(sucursal_m1)s, %(origen_archivo_m1)s, %(total_venta_m1)s), (%(id_venta_original_m2)s, %(fecha_venta_m2)s, %(producto_m2)s, %(cantidad_m2)s, %(precio_unitario_m2)s, %(sucursal_m2)s, %(origen_archivo_m2)s, %(total_venta_m2)s), (%(id_venta_original_m3)s, %(fecha_venta_m3)s, %(producto_m3)s, %(cantidad_m3)s, %(precio_unitario_m3)s, %(sucursal_m3)s, %(origen_archivo_m3)s, %(total_venta_m3)s), (%(id_venta_original_m4)s, %(fecha_venta_m4)s, %(producto_m4)s, %(cantidad_m4)s, %(precio_unitario_m4)s, %(sucursal_m4)s, %(origen_archivo_m4)s, %(total_venta_m4)s), (%(id_venta_original_m5)s, %(fecha_venta_m5)s, %(producto_m5)s, %(cantidad_m5)s, %(precio_unitario_m5)s, %(sucursal_m5)s, %(origen_archivo_m5)s, %(total_venta_m5)s), (%(id_venta_original_m6)s, %(fecha_venta_m6)s, %(producto_m6)s, %(cantidad_m6)s, %(precio_unitario_m6)s, %(sucursal_m6)s, %(origen_archivo_m6)s, %(total_venta_m6)s), (%(id_venta_original_m7)s, %(fecha_venta_m7)s, %(producto_m7)s, %(cantidad_m7)s, %(precio_unitario_m7)s, %(sucursal_m7)s, %(origen_archivo_m7)s, %(total_venta_m7)s), (%(id_venta_original_m8)s, %(fecha_venta_m8)s, %(producto_m8)s, %(cantidad_m8)s, %(precio_unitario_m8)s, %(sucursal_m8)s, %(origen_archivo_m8)s, %(total_venta_m8)s), (%(id_venta_original_m9)s, %(fecha_venta_m9)s, %(producto_m9)s, %(cantidad_m9)s, %(precio_unitario_m9)s, %(sucursal_m9)s, %(origen_archivo_m9)s, %(total_venta_m9)s), (%(id_venta_original_m10)s, %(fecha_venta_m10)s, %(producto_m10)s, %(cantidad_m10)s, %(precio_unitario_m10)s, %(sucursal_m10)s, %(origen_archivo_m10)s, %(total_venta_m10)s), (%(id_venta_original_m11)s, %(fecha_venta_m11)s, %(producto_m11)s, %(cantidad_m11)s, %(precio_unitario_m11)s, %(sucursal_m11)s, %(origen_archivo_m11)s, %(total_venta_m11)s)]
[parameters: {'id_venta_original_m0': 201, 'fecha_venta_m0': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m0': 'IMPRESORA', 'cantidad_m0': 1, 'precio_unitario_m0': 250.5, 'sucursal_m0': 'Sur', 'origen_archivo_m0': 'ventas_sur.csv', 'total_venta_m0': 250.5, 'id_venta_original_m1': 202, 'fecha_venta_m1': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m1': 'LAPTOP', 'cantidad_m1': 2, 'precio_unitario_m1': 1100.0, 'sucursal_m1': 'Sur', 'origen_archivo_m1': 'ventas_sur.csv', 'total_venta_m1': 2200.0, 'id_venta_original_m2': 203, 'fecha_venta_m2': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m2': 'TABLET', 'cantidad_m2': 5, 'precio_unitario_m2': 300.0, 'sucursal_m2': 'Sur', 'origen_archivo_m2': 'ventas_sur.csv', 'total_venta_m2': 1500.0, 'id_venta_original_m3': 204, 'fecha_venta_m3': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m3': 'MOUSE', 'cantidad_m3': 10, 'precio_unitario_m3': 18.5, 'sucursal_m3': 'Sur', 'origen_archivo_m3': 'ventas_sur.csv', 'total_venta_m3': 185.0, 'id_venta_original_m4': 101, 'fecha_venta_m4': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m4': 'LAPTOP', 'cantidad_m4': 1, 'precio_unitario_m4': 1200.0, 'sucursal_m4': 'Norte', 'origen_archivo_m4': 'ventas_norte.csv', 'total_venta_m4': 1200.0, 'id_venta_original_m5': 102, 'fecha_venta_m5': datetime.datetime(2024, 1, 16, 0, 0), 'producto_m5': 'MOUSE', 'cantidad_m5': 5, 'precio_unitario_m5': 20.0, 'sucursal_m5': 'Norte', 'origen_archivo_m5': 'ventas_norte.csv', 'total_venta_m5': 100.0, 'id_venta_original_m6': 103, 'fecha_venta_m6': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m6': 'TECLADO', 'cantidad_m6': 2, 'precio_unitario_m6': 45.0, 'sucursal_m6': 'Norte', 'origen_archivo_m6': 'ventas_norte.csv', 'total_venta_m6': 90.0, 'id_venta_original_m7': 104, 'fecha_venta_m7': datetime.datetime(2024, 1, 18, 0, 0), 'producto_m7': 'MONITOR', 'cantidad_m7': 1, 'precio_unitario_m7': 300.0, 'sucursal_m7': 'Norte', 'origen_archivo_m7': 'ventas_norte.csv', 'total_venta_m7': 300.0, 'id_venta_original_m8': 105, 'fecha_venta_m8': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m8': 'LAPTOP', 'cantidad_m8': 1, 'precio_unitario_m8': 1200.0, 'sucursal_m8': 'Norte', 'origen_archivo_m8': 'ventas_norte.csv', 'total_venta_m8': 1200.0, 'id_venta_original_m9': 301, 'fecha_venta_m9': datetime.datetime(2024, 1, 15, 0, 0), 'producto_m9': 'DISCO DURO', 'cantidad_m9': 2, 'precio_unitario_m9': 80.0, 'sucursal_m9': 'Este', 'origen_archivo_m9': 'ventas_este.csv', 'total_venta_m9': 160.0, 'id_venta_original_m10': 303, 'fecha_venta_m10': datetime.datetime(2024, 1, 17, 0, 0), 'producto_m10': 'MICROFONO', 'cantidad_m10': 1, 'precio_unitario_m10': 120.0, 'sucursal_m10': 'Este', 'origen_archivo_m10': 'ventas_este.csv', 'total_venta_m10': 120.0, 'id_venta_original_m11': 305, 'fecha_venta_m11': datetime.datetime(2024, 1, 19, 0, 0), 'producto_m11': 'MONITOR', 'cantidad_m11': 2, 'precio_unitario_m11': 421.27, 'sucursal_m11': 'Este', 'origen_archivo_m11': 'ventas_este.csv', 'total_venta_m11': 842.54}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-17 02:40:57,097 - INFO - Iniciando Pipeline ETL de Ventas
2025-12-17 02:40:57,097 - INFO - -- Paso 1: Extraccion --
2025-12-17 02:40:57,099 - INFO - Archivo cargado: ventas_sur.csv | Filas: 4
2025-12-17 02:40:57,100 - INFO - Archivo cargado: ventas_norte.csv | Filas: 5
2025-12-17 02:40:57,100 - INFO - Archivo cargado: ventas_este.csv | Filas: 5
2025-12-17 02:40:57,100 - INFO - Se extrajeron 3 DataFrames exitosamente
2025-12-17 02:40:57,100 - INFO - -- Paso 2: Transformacion --
2025-12-17 02:40:57,100 - INFO - Iniciando transformacion de los datos...
2025-12-17 02:40:57,104 - INFO - Datos transformados. Total de filas a cargar: 12
2025-12-17 02:40:57,104 - INFO - -- Paso 3: Carga (Load) --
2025-12-17 02:40:57,104 - INFO - Conectando a: postgresql+psycopg2://donosty:***@localhost:5432/retail_db
2025-12-17 02:40:57,147 - INFO - Pipeline finalizado con exito
